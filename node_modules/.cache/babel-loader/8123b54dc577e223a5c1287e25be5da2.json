{"ast":null,"code":"import _classCallCheck from \"/home/admin1/Documents/parct/fabric_pract/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/admin1/Documents/parct/fabric_pract/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/admin1/Documents/parct/fabric_pract/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/admin1/Documents/parct/fabric_pract/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/admin1/Documents/parct/fabric_pract/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/admin1/Documents/parct/fabric_pract/src/Component/DragDrop/DragDrop.jsx\";\nimport \"./DragDrop.css\";\nimport { fabric } from \"fabric\";\nimport React, { PureComponent } from \"react\";\nimport { connect } from \"react-redux\";\nimport { getImageSrc } from \"../../actions/FetchImages/FetchImage\";\nimport { getFontsList } from \"../../actions/FetchFontFamily/FetchFontFamily\";\nimport { DrawText, Images, FontFamily, Input, TextAlign, Download, Group, Ungroup, MultipleSelection, Backward, Forward, RangeBarReact, ButtonReact } from \"../Import/ImportModules\";\nfabric.Object.prototype.set({\n  borderColor: \"#53c5bf\",\n  cornerColor: \"#acdab5b8\",\n  cornerSize: 10,\n  padding: 1,\n  hasBorders: true,\n  rotatingPointOffset: 20,\n  cornerStyle: \"circle\" // transparentCorners: true\n\n});\n\nvar DragDrop =\n/*#__PURE__*/\nfunction (_PureComponent) {\n  _inherits(DragDrop, _PureComponent);\n\n  function DragDrop(props) {\n    var _this;\n\n    _classCallCheck(this, DragDrop);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DragDrop).call(this, props));\n    _this.state = {\n      canvas: \"\",\n      selectedImg: \"\",\n      selectedColor: \"#000000\",\n      selectedBackGroundColor: \"#77a05f\",\n      selectedFontFamily: \"Helvetica Neue\",\n      fontSize: 30,\n      copyPasteVisibility: false,\n      textVisibility: false,\n      selectedTextAlign: \"\",\n      fontFamilys: [],\n      textAligns: [\"left\", \"right\", \"center\", \"justify\"],\n      imgSrc: [],\n      cloneObject: \"\"\n    };\n\n    _this.onDragStart = function (event) {\n      _this.setState({\n        selectedImg: event.target\n      });\n\n      event.dataTransfer.setData(\"text/i\", event.target.src);\n      console.log(event.dataTransfer.types, \"Drag\");\n    };\n\n    _this.drawImage = function (event) {\n      console.log(\"DrawImage --->\", event.e.dataTransfer.getData(\"text/i\"));\n      event.e.preventDefault();\n      fabric.Image.fromURL(_this.state.selectedImg.src, function (img) {\n        img.set({\n          left: 10,\n          top: 0 // border: \"#000\",\n          // stroke: \"#F0F0F0\",\n          // strokeWidth: 5\n\n        });\n        img.scaleToHeight(500);\n        img.scaleToWidth(500);\n\n        _this.state.canvas.add(img).renderAll();\n      });\n    };\n\n    _this.onChangeFontFamily = function (e) {\n      if (_this.state.canvas.getActiveObject()) {\n        _this.setState({\n          selectedFontFamily: e.target.value\n        });\n\n        _this.state.canvas.getActiveObject().set(\"fontFamily\", e.target.value);\n\n        _this.state.canvas.renderAll();\n      } else {\n        return alert(\"select Text\");\n      }\n    };\n\n    _this.onChangeTextAlign = function (e) {\n      if (_this.state.canvas.getActiveObject()) {\n        _this.setState({\n          selectedTextAlign: e.target.value\n        });\n\n        _this.state.canvas.getActiveObject().set(\"textAlign\", e.target.value);\n\n        _this.state.canvas.renderAll();\n      } else {\n        return alert(\"select Text\");\n      }\n    };\n\n    _this.onRemoveElement = function (key) {\n      _this.state.canvas.remove(_this.state.canvas.getActiveObject());\n    };\n\n    _this.onChangeColor = function (e) {\n      if (_this.state.canvas.getActiveObject()) {\n        _this.setState({\n          selectedColor: e.target.value\n        });\n\n        _this.state.canvas.getActiveObject().set(\"fill\", e.target.value);\n\n        _this.state.canvas.renderAll();\n      } else {\n        return alert(\"select Text\");\n      }\n    };\n\n    _this.onChangeBackGroundColor = function (e) {\n      _this.setState({\n        selectedBackGroundColor: e.target.value\n      }, function () {\n        _this.state.canvas.setBackgroundColor(_this.state.selectedBackGroundColor, function () {\n          _this.state.canvas.renderAll();\n        });\n      });\n    };\n\n    _this.onChangeFontSize = function (e) {\n      if (/^\\d*$/.test(e.target.value)) {\n        if (_this.state.canvas.getActiveObject()) {\n          _this.setState({\n            fontSize: e.target.value\n          });\n\n          _this.state.canvas.getActiveObject().set(\"fontSize\", e.target.value * 72 / 96);\n\n          _this.state.canvas.renderAll();\n        } else {\n          return alert(\"select Text\");\n        }\n      }\n    };\n\n    _this.onCopy = function (e) {\n      if (_this.state.canvas.getActiveObject() === undefined || _this.state.canvas.getActiveObject() === null) {\n        return \"\";\n      }\n\n      _this.state.canvas.getActiveObject().clone(function (cloned) {\n        _this.setState({\n          cloneObject: cloned\n        });\n      });\n    };\n\n    _this.onPaste = function (e) {\n      var _cloneObject = _this.state.cloneObject;\n\n      if (!_cloneObject) {\n        return \"\";\n      }\n\n      _cloneObject.clone(function (clonedObj) {\n        _this.state.canvas.discardActiveObject();\n\n        clonedObj.set({\n          left: clonedObj.left + 10,\n          top: clonedObj.top + 10,\n          evented: true\n        });\n\n        if (clonedObj.type === \"activeSelection\") {\n          clonedObj.canvas = _this.state.canvas;\n          clonedObj.forEachObject(function (obj) {\n            this.state.canvas.add(obj);\n          });\n          clonedObj.setCoords();\n          alert(\"activeSelection\");\n        } else {\n          _this.state.canvas.add(clonedObj);\n        }\n\n        _cloneObject.top += 10;\n        _cloneObject.left += 10;\n\n        _this.state.canvas.setActiveObject(clonedObj);\n\n        _this.state.canvas.requestRenderAll();\n      });\n    };\n\n    _this.canvasRef = React.createRef();\n    return _this;\n  }\n\n  _createClass(DragDrop, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var canvas = new fabric.Canvas(this.canvasRef.current, {\n        preserveObjectStacking: true,\n        uniScaleTransform: true\n      });\n      this.setState({\n        canvas: canvas\n      });\n      canvas.on(\"drop\", this.drawImage); // visibility show Text Entered\n\n      canvas.on(\"text:editing:entered\", function (e) {\n        _this2.setState({\n          textVisibility: true\n        });\n      }); // visibility hidden Text Entered\n\n      canvas.on(\"text:editing:exited\", function (e) {\n        _this2.setState({\n          textVisibility: false\n        });\n      }); // visibility show copy\n\n      canvas.on(\"object:selected\", function (e) {\n        _this2.setState({\n          copyPasteVisibility: true\n        });\n      }); // visibility hidden copy\n\n      canvas.on(\"selection:cleared\", function (e) {\n        _this2.setState({\n          copyPasteVisibility: false\n        });\n      });\n      document.addEventListener(\"keydown\", function (key) {\n        if (canvas.getActiveObject()) {\n          if (key.shiftKey && key.keyCode === 68) // 46 delete 68 D key.keyCode === 46 ||\n            //selected Object Delete\n            _this2.onRemoveElement();\n          if ((key.ctrlKey || key.keyCode === 17) && key.keyCode === 86) // 17 ctrl 86 V\n            //selected Object Paste\n            _this2.onPaste();\n          if ((key.ctrlKey || key.keyCode === 17) && key.keyCode === 67) // 17 ctrl 86 C\n            //selected Object Copy\n            _this2.onCopy();\n        }\n      });\n      this.props.onGetImageSrc();\n      this.props.onGetFontsList();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.state.canvas.off(\"drop\");\n      document.removeEventListener(\"keypress\");\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"left\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, this.state.imgSrc.map(function (src, ind) {\n        return React.createElement(Images, {\n          src: src,\n          key: ind,\n          onDragStart: _this3.onDragStart,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 248\n          },\n          __self: this\n        });\n      })), React.createElement(\"div\", {\n        className: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          justifyContent: \"space-evenly\",\n          padding: \"20px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      }, React.createElement(Input, {\n        id: \"backGroundColor\",\n        type: \"color\",\n        value: this.state.selectedBackGroundColor,\n        onChange: this.onChangeBackGroundColor,\n        displayText: \"Background Color\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }), React.createElement(DrawText, {\n        canvas: this.state.canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270\n        },\n        __self: this\n      }, React.createElement(MultipleSelection, {\n        canvas: this.state.canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: function onClick(e) {\n          return _this3.state.canvas.discardActiveObject() && _this3.state.canvas.requestRenderAll();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }, \"Deselect\"))), React.createElement(Download, {\n        canvas: this.state.canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        className: !this.state.copyPasteVisibility ? \"visibility\" : \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292\n        },\n        __self: this\n      }, React.createElement(Group, {\n        canvas: this.state.canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }), React.createElement(Ungroup, {\n        canvas: this.state.canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }, React.createElement(Backward, {\n        canvas: this.state.canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      }), React.createElement(Forward, {\n        canvas: this.state.canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298\n        },\n        __self: this\n      })), React.createElement(RangeBarReact, {\n        canvas: this.state.canvas,\n        id: \"transparent\",\n        displayText: \"Transparent\",\n        rangeMin: 0,\n        rangeMax: 100,\n        rangeStep: 10,\n        value: 100,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.onCopy,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      }, \"Copy\")), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.onPaste,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }, \"Paste\")))), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          justifyContent: \"space-evenly\",\n          padding: \"20px\"\n        },\n        className: !this.state.textVisibility ? \"visibility\" : \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, React.createElement(FontFamily, {\n        selectedFontFamily: this.state.selectedFontFamily,\n        fonts: this.state.fontFamilys,\n        onChangeFontFamily: this.onChangeFontFamily,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }), React.createElement(TextAlign, {\n        selectedTextAlign: this.state.selectedTextAlign,\n        onChangeTextAlign: this.onChangeTextAlign,\n        aligns: this.state.textAligns,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330\n        },\n        __self: this\n      }), React.createElement(Input, {\n        id: \"fontColor\",\n        type: \"color\",\n        value: this.state.selectedColor,\n        onChange: this.onChangeColor,\n        displayText: \"Font Color\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335\n        },\n        __self: this\n      }), React.createElement(Input, {\n        id: \"fontSize\",\n        type: \"text\",\n        value: this.state.fontSize,\n        onChange: this.onChangeFontSize,\n        displayText: \"Font Size\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342\n        },\n        __self: this\n      }), React.createElement(RangeBarReact, {\n        canvas: this.state.canvas,\n        id: \"lineHeight\",\n        displayText: \"Line Height\",\n        rangeMin: 0.5,\n        rangeMax: 2.5,\n        rangeStep: 0.2,\n        value: 1.16,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 349\n        },\n        __self: this\n      }), React.createElement(RangeBarReact, {\n        canvas: this.state.canvas,\n        id: \"letterSpacing\",\n        displayText: \"Letter Spacing\",\n        rangeMin: -200,\n        rangeMax: 800,\n        rangeStep: 1,\n        value: 10,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      }), React.createElement(ButtonReact, {\n        id: \"bold\",\n        canvas: this.state.canvas,\n        displayText: \"B\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368\n        },\n        __self: this\n      }), React.createElement(ButtonReact, {\n        id: \"underLine\",\n        canvas: this.state.canvas,\n        displayText: \"U\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373\n        },\n        __self: this\n      }), React.createElement(ButtonReact, {\n        id: \"italic\",\n        canvas: this.state.canvas,\n        displayText: \"I\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378\n        },\n        __self: this\n      }))), React.createElement(\"canvas\", {\n        ref: this.canvasRef,\n        height: \"500%\",\n        width: \"700%\",\n        className: \"canvas\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 385\n        },\n        __self: this\n      })))));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.imgSrcData.readyState === 4) {\n        return {\n          imgSrc: nextProps.imgSrcData.imgSrcList\n        };\n      } else if (nextProps.fontListData.readyState === 4) {\n        return {\n          fontFamilys: nextProps.fontListData.fontList\n        };\n      } else return null;\n    }\n  }]);\n\n  return DragDrop;\n}(PureComponent);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    imgSrcData: state.getImagesSrc,\n    fontListData: state.getFontList\n  };\n};\n\nvar mapDispatchToProps = {\n  onGetImageSrc: getImageSrc,\n  onGetFontsList: getFontsList\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(DragDrop); //Crop images","map":{"version":3,"sources":["/home/admin1/Documents/parct/fabric_pract/src/Component/DragDrop/DragDrop.jsx"],"names":["fabric","React","PureComponent","connect","getImageSrc","getFontsList","DrawText","Images","FontFamily","Input","TextAlign","Download","Group","Ungroup","MultipleSelection","Backward","Forward","RangeBarReact","ButtonReact","Object","prototype","set","borderColor","cornerColor","cornerSize","padding","hasBorders","rotatingPointOffset","cornerStyle","DragDrop","props","state","canvas","selectedImg","selectedColor","selectedBackGroundColor","selectedFontFamily","fontSize","copyPasteVisibility","textVisibility","selectedTextAlign","fontFamilys","textAligns","imgSrc","cloneObject","onDragStart","event","setState","target","dataTransfer","setData","src","console","log","types","drawImage","e","getData","preventDefault","Image","fromURL","img","left","top","scaleToHeight","scaleToWidth","add","renderAll","onChangeFontFamily","getActiveObject","value","alert","onChangeTextAlign","onRemoveElement","key","remove","onChangeColor","onChangeBackGroundColor","setBackgroundColor","onChangeFontSize","test","onCopy","undefined","clone","cloned","onPaste","_cloneObject","clonedObj","discardActiveObject","evented","type","forEachObject","obj","setCoords","setActiveObject","requestRenderAll","canvasRef","createRef","Canvas","current","preserveObjectStacking","uniScaleTransform","on","document","addEventListener","shiftKey","keyCode","ctrlKey","onGetImageSrc","onGetFontsList","off","removeEventListener","map","ind","display","justifyContent","nextProps","prevState","imgSrcData","readyState","imgSrcList","fontListData","fontList","mapStateToProps","getImagesSrc","getFontList","mapDispatchToProps"],"mappings":"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","sourcesContent":["import \"./DragDrop.css\";\nimport { fabric } from \"fabric\";\nimport React, { PureComponent } from \"react\";\n\nimport { connect } from \"react-redux\";\nimport { getImageSrc } from \"../../actions/FetchImages/FetchImage\";\nimport { getFontsList } from \"../../actions/FetchFontFamily/FetchFontFamily\";\n\nimport {\n  DrawText,\n  Images,\n  FontFamily,\n  Input,\n  TextAlign,\n  Download,\n  Group,\n  Ungroup,\n  MultipleSelection,\n  Backward,\n  Forward,\n  RangeBarReact,\n  ButtonReact\n} from \"../Import/ImportModules\";\n\nfabric.Object.prototype.set({\n  borderColor: \"#53c5bf\",\n  cornerColor: \"#acdab5b8\",\n  cornerSize: 10,\n  padding: 1,\n  hasBorders: true,\n  rotatingPointOffset: 20,\n  cornerStyle: \"circle\"\n  // transparentCorners: true\n});\n\nclass DragDrop extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.canvasRef = React.createRef();\n  }\n\n  state = {\n    canvas: \"\",\n    selectedImg: \"\",\n    selectedColor: \"#000000\",\n    selectedBackGroundColor: \"#77a05f\",\n    selectedFontFamily: \"Helvetica Neue\",\n    fontSize: 30,\n    copyPasteVisibility: false,\n    textVisibility: false,\n    selectedTextAlign: \"\",\n    fontFamilys: [],\n    textAligns: [\"left\", \"right\", \"center\", \"justify\"],\n    imgSrc: [],\n    cloneObject: \"\"\n  };\n\n  onDragStart = event => {\n    this.setState({ selectedImg: event.target });\n    event.dataTransfer.setData(\"text/i\", event.target.src);\n    console.log(event.dataTransfer.types, \"Drag\");\n  };\n\n  drawImage = event => {\n    console.log(\"DrawImage --->\", event.e.dataTransfer.getData(\"text/i\"));\n    event.e.preventDefault();\n    fabric.Image.fromURL(this.state.selectedImg.src, img => {\n      img.set({\n        left: 10,\n        top: 0\n\n        // border: \"#000\",\n        // stroke: \"#F0F0F0\",\n        // strokeWidth: 5\n      });\n      img.scaleToHeight(500);\n      img.scaleToWidth(500);\n      this.state.canvas.add(img).renderAll();\n    });\n  };\n\n  onChangeFontFamily = e => {\n    if (this.state.canvas.getActiveObject()) {\n      this.setState({ selectedFontFamily: e.target.value });\n      this.state.canvas.getActiveObject().set(\"fontFamily\", e.target.value);\n      this.state.canvas.renderAll();\n    } else {\n      return alert(\"select Text\");\n    }\n  };\n\n  onChangeTextAlign = e => {\n    if (this.state.canvas.getActiveObject()) {\n      this.setState({ selectedTextAlign: e.target.value });\n      this.state.canvas.getActiveObject().set(\"textAlign\", e.target.value);\n      this.state.canvas.renderAll();\n    } else {\n      return alert(\"select Text\");\n    }\n  };\n\n  onRemoveElement = key => {\n    this.state.canvas.remove(this.state.canvas.getActiveObject());\n  };\n\n  onChangeColor = e => {\n    if (this.state.canvas.getActiveObject()) {\n      this.setState({ selectedColor: e.target.value });\n      this.state.canvas.getActiveObject().set(\"fill\", e.target.value);\n      this.state.canvas.renderAll();\n    } else {\n      return alert(\"select Text\");\n    }\n  };\n\n  onChangeBackGroundColor = e => {\n    this.setState({ selectedBackGroundColor: e.target.value }, () => {\n      this.state.canvas.setBackgroundColor(\n        this.state.selectedBackGroundColor,\n        () => {\n          this.state.canvas.renderAll();\n        }\n      );\n    });\n  };\n\n  onChangeFontSize = e => {\n    if (/^\\d*$/.test(e.target.value)) {\n      if (this.state.canvas.getActiveObject()) {\n        this.setState({ fontSize: e.target.value });\n        this.state.canvas\n          .getActiveObject()\n          .set(\"fontSize\", (e.target.value * 72) / 96);\n        this.state.canvas.renderAll();\n      } else {\n        return alert(\"select Text\");\n      }\n    }\n  };\n\n  onCopy = e => {\n    if (\n      this.state.canvas.getActiveObject() === undefined ||\n      this.state.canvas.getActiveObject() === null\n    ) {\n      return \"\";\n    }\n    this.state.canvas.getActiveObject().clone(cloned => {\n      this.setState({ cloneObject: cloned });\n    });\n  };\n\n  onPaste = e => {\n    let _cloneObject = this.state.cloneObject;\n    if (!_cloneObject) {\n      return \"\";\n    }\n    _cloneObject.clone(clonedObj => {\n      this.state.canvas.discardActiveObject();\n      clonedObj.set({\n        left: clonedObj.left + 10,\n        top: clonedObj.top + 10,\n        evented: true\n      });\n      if (clonedObj.type === \"activeSelection\") {\n        clonedObj.canvas = this.state.canvas;\n        clonedObj.forEachObject(function(obj) {\n          this.state.canvas.add(obj);\n        });\n        clonedObj.setCoords();\n        alert(\"activeSelection\");\n      } else {\n        this.state.canvas.add(clonedObj);\n      }\n      _cloneObject.top += 10;\n      _cloneObject.left += 10;\n      this.state.canvas.setActiveObject(clonedObj);\n      this.state.canvas.requestRenderAll();\n    });\n  };\n\n  componentDidMount() {\n    let canvas = new fabric.Canvas(this.canvasRef.current, {\n      preserveObjectStacking: true,\n      uniScaleTransform: true\n    });\n    this.setState({ canvas: canvas });\n\n    canvas.on(\"drop\", this.drawImage);\n\n    // visibility show Text Entered\n    canvas.on(\"text:editing:entered\", e => {\n      this.setState({ textVisibility: true });\n    });\n\n    // visibility hidden Text Entered\n    canvas.on(\"text:editing:exited\", e => {\n      this.setState({ textVisibility: false });\n    });\n\n    // visibility show copy\n    canvas.on(\"object:selected\", e => {\n      this.setState({ copyPasteVisibility: true });\n    });\n    // visibility hidden copy\n    canvas.on(\"selection:cleared\", e => {\n      this.setState({ copyPasteVisibility: false });\n    });\n\n    document.addEventListener(\"keydown\", key => {\n      if (canvas.getActiveObject()) {\n        if (key.shiftKey && key.keyCode === 68)\n          // 46 delete 68 D key.keyCode === 46 ||\n          //selected Object Delete\n          this.onRemoveElement();\n        if ((key.ctrlKey || key.keyCode === 17) && key.keyCode === 86)\n          // 17 ctrl 86 V\n          //selected Object Paste\n          this.onPaste();\n        if ((key.ctrlKey || key.keyCode === 17) && key.keyCode === 67)\n          // 17 ctrl 86 C\n          //selected Object Copy\n          this.onCopy();\n      }\n    });\n    this.props.onGetImageSrc();\n    this.props.onGetFontsList();\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    if (nextProps.imgSrcData.readyState === 4) {\n      return { imgSrc: nextProps.imgSrcData.imgSrcList };\n    } else if (nextProps.fontListData.readyState === 4) {\n      return { fontFamilys: nextProps.fontListData.fontList };\n    } else return null;\n  }\n\n  componentWillUnmount() {\n    this.state.canvas.off(\"drop\");\n    document.removeEventListener(\"keypress\");\n  }\n  render() {\n    return (\n      <div>\n        <div className=\"container\">\n          <div className=\"left\">\n            {this.state.imgSrc.map((src, ind) => (\n              <Images src={src} key={ind} onDragStart={this.onDragStart} />\n            ))}\n          </div>\n\n          <div className=\"right\">\n            <div>\n              <div>\n                <div\n                  style={{\n                    display: \"flex\",\n                    justifyContent: \"space-evenly\",\n                    padding: \"20px\"\n                  }}\n                >\n                  <Input\n                    id=\"backGroundColor\"\n                    type=\"color\"\n                    value={this.state.selectedBackGroundColor}\n                    onChange={this.onChangeBackGroundColor}\n                    displayText=\"Background Color\"\n                  />\n                  <DrawText canvas={this.state.canvas} />\n                  <div style={{ display: \"flex\" }}>\n                    <MultipleSelection canvas={this.state.canvas} />\n                    <div>\n                      <button\n                        onClick={e =>\n                          this.state.canvas.discardActiveObject() &&\n                          this.state.canvas.requestRenderAll()\n                        }\n                      >\n                        Deselect\n                      </button>\n                    </div>\n                  </div>\n                  <Download canvas={this.state.canvas} />\n                  <div\n                    style={{\n                      display: \"flex\"\n                    }}\n                    className={\n                      !this.state.copyPasteVisibility ? \"visibility\" : \"\"\n                    }\n                  >\n                    <div style={{ display: \"flex\" }}>\n                      <Group canvas={this.state.canvas} />\n                      <Ungroup canvas={this.state.canvas} />\n                    </div>\n                    <div style={{ display: \"flex\" }}>\n                      <Backward canvas={this.state.canvas} />\n                      <Forward canvas={this.state.canvas} />\n                    </div>\n                    <RangeBarReact\n                      canvas={this.state.canvas}\n                      id=\"transparent\"\n                      displayText=\"Transparent\"\n                      rangeMin={0}\n                      rangeMax={100}\n                      rangeStep={10}\n                      value={100}\n                    />\n                    <div>\n                      <button onClick={this.onCopy}>Copy</button>\n                    </div>\n                    <div>\n                      <button onClick={this.onPaste}>Paste</button>\n                    </div>\n                  </div>\n                </div>\n                <div\n                  style={{\n                    display: \"flex\",\n                    justifyContent: \"space-evenly\",\n                    padding: \"20px\"\n                  }}\n                  className={!this.state.textVisibility ? \"visibility\" : \"\"}\n                >\n                  <FontFamily\n                    selectedFontFamily={this.state.selectedFontFamily}\n                    fonts={this.state.fontFamilys}\n                    onChangeFontFamily={this.onChangeFontFamily}\n                  />\n                  <TextAlign\n                    selectedTextAlign={this.state.selectedTextAlign}\n                    onChangeTextAlign={this.onChangeTextAlign}\n                    aligns={this.state.textAligns}\n                  />\n                  <Input\n                    id=\"fontColor\"\n                    type=\"color\"\n                    value={this.state.selectedColor}\n                    onChange={this.onChangeColor}\n                    displayText=\"Font Color\"\n                  />\n                  <Input\n                    id=\"fontSize\"\n                    type=\"text\"\n                    value={this.state.fontSize}\n                    onChange={this.onChangeFontSize}\n                    displayText=\"Font Size\"\n                  />\n                  <RangeBarReact\n                    canvas={this.state.canvas}\n                    id=\"lineHeight\"\n                    displayText=\"Line Height\"\n                    rangeMin={0.5}\n                    rangeMax={2.5}\n                    rangeStep={0.2}\n                    value={1.16}\n                  />\n\n                  <RangeBarReact\n                    canvas={this.state.canvas}\n                    id=\"letterSpacing\"\n                    displayText=\"Letter Spacing\"\n                    rangeMin={-200}\n                    rangeMax={800}\n                    rangeStep={1}\n                    value={10}\n                  />\n                  <ButtonReact\n                    id=\"bold\"\n                    canvas={this.state.canvas}\n                    displayText={\"B\"}\n                  />\n                  <ButtonReact\n                    id=\"underLine\"\n                    canvas={this.state.canvas}\n                    displayText={\"U\"}\n                  />\n                  <ButtonReact\n                    id=\"italic\"\n                    canvas={this.state.canvas}\n                    displayText={\"I\"}\n                  />\n                </div>\n              </div>\n              <canvas\n                ref={this.canvasRef}\n                height=\"500%\"\n                width=\"700%\"\n                className=\"canvas\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return { imgSrcData: state.getImagesSrc, fontListData: state.getFontList };\n};\n\nconst mapDispatchToProps = {\n  onGetImageSrc: getImageSrc,\n  onGetFontsList: getFontsList\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(DragDrop);\n\n//Crop images\n"]},"metadata":{},"sourceType":"module"}